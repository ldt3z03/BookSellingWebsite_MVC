@model IEnumerable<Product>

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trang Chủ</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- Carousel -->
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner">
            @foreach (var product in Model.Take(3)) // Lấy ba sản phẩm đầu tiên cho băng truyền
            {
                <div class="carousel-item @(product == Model.First() ? "active" : "")">
                    <a asp-action="Details" asp-route-productId="@product.Id">
                        <img src="@(product.ProductImages.FirstOrDefault()?.ImageUrl ?? "https://via.placeholder.com/500")" class="d-block w-100" alt="Image @product.Title">
                    </a>
                </div>
            }
        </div>

        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>

    </div>
    <!-- Tiêu đề phía dưới carousel -->
    <div id="title-Hot" class="text-center">
        <p class="test">Các sản phẩm nổi bật</p>
    </div>

    @*
    <div class="owl-one owl-carousel owl-theme owl-loaded owl-drag"> *@


    <section id="intro-section" class="w3l-passion-mid-sec home-phny py-5">
        <div class="container py-md-5 py-3">
            <div class="container HomePageAbout">
                <div class="row w3l-passion-mid-grids">
                    <div class="col-lg-6 passion-grid-item-info pe-lg-5 mb-lg-0 mb-5">
                        <h6 class="title-subw3hny mb-1">Welcome</h6>
                        <h3 class="title-w3l mb-4">TTP Sells books &amp; xây dựng phát triển website</h3>
                        <p class="mt-3 pe-lg-5">Chúng tôi ở đây để bán sách và đem tới trải nghiệm cho người dùng. Dưới đây là các sản phẩm chúng tôi đang bày bán với các chương trình ưu đãi dành cho khách hàng.</p>
                    </div>
                    <div class="col-lg-6 w3hny-passion-item">
                        <div class="row">
                            <div class="col-6 passion-grid-item-pic">
                                <img src="~/images/imagesdesign/introduct1.jpg" alt="" class="img-fluid radius-image">
                            </div>
                            <div class="col-6 passion-grid-item-pic">
                                <img src="~/images/imagesdesign/introduct3.jpg" alt="" class="img-fluid radius-image">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <div id="stats-section" class="w3l-stats-section stats-con mt-5 HomePageStats">
        <div class="stats_info counter_grid ps-0">
            <p class="counter">3500</p>
            <h3>Factories</h3>
        </div>
        <div class="stats_info counter_grid">
            <p class="counter">4360</p>
            <h3>Projects</h3>
        </div>
    </div>
    <script>
        function startCounting(element, target) {
            let count = 0;
            const duration = 5000; // Thời gian (ms) để chạy từ 0 đến số cần đạt
            const fps = 30; // Số hình ảnh trên giây
            const step = target / Math.floor(duration / 100); // Tính bước tăng cho mỗi lần cập nhật

            const timer = setInterval(() => {
                count += step; // Tăng giá trị đếm
                if (count >= target) {
                    clearInterval(timer); // Dừng đếm khi đạt đến giá trị cần
                    count = target; // Đặt giá trị cuối cùng là giá trị cần đạt
                }
                element.textContent = Math.floor(count); // Cập nhật giá trị hiển thị trên trang
            }, 100);
        }

        const counters = document.querySelectorAll('.counter'); // Chọn tất cả các phần tử có class 'counter'

        counters.forEach(counter => {
            const target = parseInt(counter.textContent); // Lấy giá trị cần đạt từ nội dung của phần tử
            startCounting(counter, target); // Bắt đầu đếm từ 0 đến giá trị cần đạt
        });
    </script>


    <div class="container">
        <div class="row pb-3">
            @foreach (var product in Model)
            {
                <div class="col-lg-3 col-sm-6">
                    <div class="row p-2">
                        <div class="col-12 p-1">
                            <div class="card border-0 p-3 shadow border-top border-5 rounded">
                                @if (product.ProductImages != null && product.ProductImages.Count() > 0)
                                {
                                    <img src="@product.ProductImages.FirstOrDefault().ImageUrl" class="card-img-top rounded" />
                                }
                                else
                                {
                                    <img src="https://placehold.co/500x600/png" class="card-img-top rounded" />
                                }
                                <div class="card-body pb-0">
                                    <div class="pl-1">
                                        <p class="card-title h5 text-dark opacity-75 text-uppercase text-center">@product.Title</p>
                                        <p class="card-title text-warning text-center">by <b>@product.Author</b></p>
                                    </div>
                                    <div class="pl-1">
                                        <p class="text-dark text-opacity-75 text-center mb-0">
                                            List Price:
                                            <span class="text-decoration-line-through">
                                                @product.ListPrice.ToString("c")
                                            </span>
                                        </p>
                                    </div>
                                    <div class="pl-1">
                                        <p class="text-dark text-opacity-75 text-center">
                                            As low as:
                                            <span>
                                                @product.Price100.ToString("c")
                                            </span>
                                        </p>
                                    </div>
                                </div>
                                <div>
                                    <a asp-action="Details"
                                       asp-route-productId="@product.Id"
                                       class="btn btn-primary bg-gradient border-0 form-control">
                                        Details
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var searchString = '@ViewBag.CurrentFilter';
            if (searchString) {
                document.getElementById("carouselExampleIndicators").style.display = "none";
                document.getElementById("title-Hot").style.display = "none";
                document.getElementById("stats-section").style.display = "none";
                document.getElementById("intro-section").style.display = "none";

            }
        });
    </script>
</body>
</html>

<script>
    $(document).ready(function () {
        // Sử dụng the carousel
        $('#carouselExampleSlidesOnly').carousel();

        // Auto slide
        $('#carouselExampleSlidesOnly').carousel({
            interval: 700 // Thời gian chờ giữa các lần chuyển đổi, tính bằng mili giây
        });
    });
</script>
